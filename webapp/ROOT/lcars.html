<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Starfleet Tricorder MK IV</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* LCARS Custom Styling */
        body {
            background-color: #111827; /* Dark Grey/Blue background */
            font-family: 'Inter', sans-serif;
            color: #FF9900; /* LCARS Gold/Orange Text */
            overflow: hidden; /* Prevent scrolling */
        }

        /* LCARS Panel Base */
        .lcars-panel {
            background-color: #3B82F6; /* LCARS Blue */
            border-radius: 20px;
            padding: 1rem;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.5);
        }

        /* LCARS Primary Button */
        .lcars-button {
            background-color: #DC2626; /* LCARS Red */
            color: #FF9900;
            font-weight: 700;
            border-radius: 20px;
            padding: 0.75rem 1rem;
            text-align: center;
            transition: background-color 0.1s;
        }

        .lcars-button:active {
            background-color: #B91C1C;
        }

        /* Pulse Animation for Scanning */
        @keyframes pulse-scan {
            0% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 0.8; }
        }

        .scanning-animation {
            animation: pulse-scan 2s infinite ease-in-out;
        }

        /* Reading Text Styles */
        .reading-text-green { color: #10B981; } /* Diagnostic/Normal */
        .reading-text-yellow { color: #F59E0B; } /* Warning/Fluctuation */
        .reading-text-red { color: #EF4444; } /* Critical/Danger */
        .reading-text-blue { color: #60A5FA; } /* Informational/Static */

    </style>
</head>
<body class="p-4 h-screen flex flex-col gap-4">

    <!-- Header Panel (Title and Status) -->
    <div class="lcars-panel bg-[#DC2626] text-white flex justify-between items-center px-6 py-2">
        <h1 class="text-2xl font-extrabold tracking-widest">TRICORDER MK IV</h1>
        <span id="status-indicator" class="text-lg font-mono reading-text-green">READY</span>
    </div>

    <!-- Main Display Section (Scanning View) -->
    <div class="flex-grow flex flex-col md:flex-row gap-4">
        <!-- Left Panel: Scanning Graphics & Primary Reading -->
        <div class="lcars-panel bg-[#DC2626] w-full md:w-1/3 flex flex-col items-center justify-center p-6 space-y-4 scanning-animation">
            <div id="primary-reading-label" class="text-xl font-bold tracking-wider text-white">SUBSPACE FIELD DENSITY</div>
            <div id="primary-reading-value" class="text-6xl font-mono text-[#F59E0B] font-extrabold">2.44 TFL</div>
            <div class="w-2/3 h-2 bg-[#F59E0B] rounded-full"></div>
            <div id="target-info" class="text-sm font-mono reading-text-blue">TARGET: UNIDENTIFIED SIGNAL SOURCE</div>
        </div>

        <!-- Right Panel: Data Readout List -->
        <div class="lcars-panel bg-[#3B82F6] w-full md:w-2/3 flex flex-col gap-2 p-4">
            <div class="text-xl font-bold tracking-wider mb-2 text-white">CURRENT DIAGNOSTIC SCAN</div>
            <div id="readout-container" class="space-y-2 overflow-y-auto h-full">
                <!-- Data Readings will be injected here -->
            </div>
        </div>
    </div>

    <!-- Control Panel (LCARS Buttons) -->
    <div class="flex justify-around gap-4 p-2">
        <button class="lcars-button bg-[#3B82F6] hover:bg-[#2563EB] w-1/3" data-mode="biological">BIOLOGICAL</button>
        <button class="lcars-button bg-[#DC2626] hover:bg-[#B91C1C] w-1/3" data-mode="geological">GEOLOGICAL</button>
        <button class="lcars-button bg-[#F59E0B] hover:bg-[#D97706] w-1/3" data-mode="atmospheric">ATMOSPHERIC</button>
    </div>


    <script>
        // --- JAVASCRIPT LOGIC ---

        // State to hold the current readings and mode
        let currentMode = 'biological';
        let readings = {};
        let intervalId = null;

        const readoutContainer = document.getElementById('readout-container');
        const primaryReadingLabel = document.getElementById('primary-reading-label');
        const primaryReadingValue = document.getElementById('primary-reading-value');
        const statusIndicator = document.getElementById('status-indicator');
        const targetInfo = document.getElementById('target-info');
        const buttons = document.querySelectorAll('.lcars-button');

        // --- DATA DEFINITIONS ---

        const DEFINITIONS = {
            biological: [
                { id: 'heart', label: 'Heart Rate', unit: 'BPM', min: 70, max: 95, critical: 120 },
                { id: 'temp', label: 'Core Temperature', unit: '°C', min: 36.5, max: 37.5, critical: 40.0 },
                { id: 'neuro', label: 'Neural Activity', unit: 'Hz', min: 10, max: 16, critical: 25 },
                { id: 'ox', label: 'Oxygen Saturation', unit: '%', min: 95, max: 99, critical: 90 },
                { id: 'cell', label: 'Cellular Integrity', unit: 'µSv', min: 0.1, max: 0.5, critical: 2.0 }
            ],
            geological: [
                { id: 'density', label: 'Subsurface Density', unit: 'kg/m³', min: 3000, max: 5000, critical: 1000 },
                { id: 'lith', label: 'Lithium Trace', unit: 'ppm', min: 0.05, max: 0.2, critical: 0.5 },
                { id: 'field', label: 'Magnetic Field Flux', unit: 'TFL', min: 1.0, max: 3.5, critical: 4.5 },
                { id: 'seismic', label: 'Seismic Stability', unit: 'RS', min: 1.0, max: 2.5, critical: 5.0 },
                { id: 'rad', label: 'Background Radiation', unit: 'mGy', min: 0.001, max: 0.01, critical: 0.1 }
            ],
            atmospheric: [
                { id: 'press', label: 'Atmospheric Pressure', unit: 'kPa', min: 100, max: 105, critical: 80 },
                { id: 'oxy', label: 'O₂ Concentration', unit: '%', min: 20.5, max: 21.5, critical: 15.0 },
                { id: 'trace', label: 'Trace Noble Gases', unit: 'μg/m³', min: 5, max: 15, critical: 30 },
                { id: 'humidity', label: 'Relative Humidity', unit: '%', min: 40, max: 60, critical: 80 },
                { id: 'tempAir', label: 'Ambient Temperature', unit: '°C', min: 15, max: 25, critical: 35 }
            ]
        };

        // --- UTILITY FUNCTIONS ---

        /** Generates a fluctuating reading */
        function generateReading(min, max, decimalPlaces) {
            const range = max - min;
            // Add a small fluctuation (up to 5% of the range)
            const fluctuation = (Math.random() - 0.5) * 0.05 * range;
            let value = (min + range * Math.random() + fluctuation);
            // Keep value within a reasonable max/min bounds
            value = Math.max(min * 0.8, Math.min(max * 1.5, value));
            return value.toFixed(decimalPlaces);
        }

        /** Determines LCARS color based on value and critical threshold */
        function getReadingStatus(value, min, max, critical) {
            const numVal = parseFloat(value);
            if (critical && (numVal > critical || numVal < (min * 0.5))) {
                return { status: 'CRITICAL', color: 'reading-text-red' };
            }
            if (numVal < min || numVal > max) {
                return { status: 'WARNING', color: 'reading-text-yellow' };
            }
            return { status: 'NORMAL', color: 'reading-text-green' };
        }

        // --- MAIN LOGIC ---

        /** Initializes the display readings for the current mode */
        function initializeReadings() {
            const definitions = DEFINITIONS[currentMode];
            readings = {};
            readoutContainer.innerHTML = ''; // Clear previous readings

            definitions.forEach(def => {
                // Initialize state
                const initialValue = generateReading(def.min, def.max, 2);
                readings[def.id] = initialValue;

                // Create DOM element
                const status = getReadingStatus(initialValue, def.min, def.max, def.critical);
                const readingElement = document.createElement('div');
                readingElement.id = `reading-${def.id}`;
                readingElement.className = 'flex justify-between items-baseline font-mono p-1 rounded-lg';
                readingElement.innerHTML = `
                    <span class="text-sm font-semibold text-white">${def.label}</span>
                    <span class="text-lg font-extrabold ${status.color}">
                        ${initialValue} ${def.unit}
                    </span>
                `;
                readoutContainer.appendChild(readingElement);
            });

            // Set Primary Display based on mode
            const primary = definitions[0];
            primaryReadingLabel.textContent = primary.label;
            primaryReadingValue.textContent = `${readings[primary.id]} ${primary.unit}`;
            targetInfo.textContent = `TARGET: ${currentMode.toUpperCase()} SCAN AREA ${Math.random() > 0.5 ? 'A' : 'B'} SECTOR ${Math.floor(Math.random() * 9) + 1}`;
            statusIndicator.className = 'text-lg font-mono reading-text-green';
            statusIndicator.textContent = 'SCANNING';
        }

        /** Updates the values of all readings */
        function updateReadings() {
            const definitions = DEFINITIONS[currentMode];
            let isCritical = false;

            definitions.forEach(def => {
                // Generate new fluctuating value
                const newValue = generateReading(def.min, def.max, 2);
                readings[def.id] = newValue;
                const status = getReadingStatus(newValue, def.min, def.max, def.critical);

                // Update DOM
                const readingElement = document.getElementById(`reading-${def.id}`);
                if (readingElement) {
                    const valueSpan = readingElement.querySelector('span:last-child');
                    valueSpan.textContent = `${newValue} ${def.unit}`;
                    valueSpan.className = `text-lg font-extrabold ${status.color}`;
                }

                if (status.status === 'CRITICAL') {
                    isCritical = true;
                }

                // Update Primary Display
                if (def.id === definitions[0].id) {
                    primaryReadingValue.textContent = `${newValue} ${def.unit}`;
                    primaryReadingValue.className = `text-6xl font-mono font-extrabold ${status.color}`;
                }
            });

            // Update Global Status
            if (isCritical) {
                statusIndicator.className = 'text-lg font-mono reading-text-red scanning-animation';
                statusIndicator.textContent = 'CRITICAL ALERT';
            } else {
                statusIndicator.className = 'text-lg font-mono reading-text-green';
                statusIndicator.textContent = 'SCANNING';
            }
        }

        /** Handles mode switching via buttons */
        function switchMode(newMode) {
            currentMode = newMode;
            // Highlight active button (simple example)
            buttons.forEach(btn => {
                btn.classList.remove('ring-4', 'ring-offset-2', 'ring-white');
                if (btn.getAttribute('data-mode') === newMode) {
                    btn.classList.add('ring-4', 'ring-offset-2', 'ring-white');
                }
            });

            // Re-initialize and restart simulation
            clearInterval(intervalId);
            initializeReadings();
            intervalId = setInterval(updateReadings, 150); // Update every 150ms
        }

        // --- EVENT LISTENERS ---

        buttons.forEach(button => {
            button.addEventListener('click', (e) => {
                const mode = e.currentTarget.getAttribute('data-mode');
                switchMode(mode);
            });
        });

        // --- INITIALIZATION ---

        window.onload = function() {
            // Start the default mode (Biological) when the page loads
            switchMode('biological');
        };

    </script>
</body>
</html>